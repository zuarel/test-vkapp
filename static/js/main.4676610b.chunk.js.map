{"version":3,"sources":["components/SubscriptionItem.js","App.js","index.js"],"names":["SubscriptionItem","item","source","subscribe","unsubscribe","isSubscriptionPage","className","name","count","isSubscribed","data-source","onClick","getObjectFromURL","url","slice","split","reduce","acc","key","value","App","hashObject","window","location","hash","subscriptionId","search","vk_group_id","s","useState","subscriptions","setSubscriptions","description","avatar","unsubscribeColor","subscribeColor","groupInfo","setGroupInfo","isGroupInfoLoading","setGroupInfoLoading","loadSubscriptions","a","fetch","mode","method","then","res","text","data","console","log","id","banner","filter","subscription","loadGroupInfo","find","pageDescription","map","i","unsubscribeItem","onUnsubscribe","activePanel","style","textAlign","src","alt","maxWidth","padding","borderRadius","marginRight","forEach","backgroundColor","connect","send","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4676610b.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\n\r\n\r\nconst SubscriptionItem = ({ item, source, subscribe, unsubscribe, isSubscriptionPage }) => {\r\n\r\n    return (\r\n        <div className={`subscriptions-group-item ${isSubscriptionPage && 'subscription-page'}`}>\r\n            <div className=\"subscriptions-group-item__info\">\r\n                <p className=\"subscriptions-group-item__title\">{item.name}</p>\r\n                <p className=\"subscriptions-group-item__count\">Подписчиков: {item.count}</p>\r\n            </div>\r\n            <div className=\"subscriptions-group-item__action-block\">\r\n\r\n                {item.isSubscribed\r\n                    ? <button data-source={source}\r\n                        onClick={() => unsubscribe(item)}\r\n                        className=\"subscriptions-group-button unsubscribe-button\">Отписаться</button>\r\n                    : <button data-source={source}\r\n                        onClick={() => subscribe(item)}\r\n                        className=\"subscriptions-group-button subscribe-button\">Подписаться</button>\r\n                }\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SubscriptionItem;","import React, { useState, useEffect } from 'react';\r\nimport connect from '@vkontakte/vk-connect';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport './css/vkapp.css';\r\n\r\nimport { Panel, PanelHeader } from '@vkontakte/vkui';\r\nimport SubscriptionsList from './components/SubscribersList';\r\nimport SubscriptionItem from './components/SubscriptionItem';\r\nimport axios from 'axios';\r\n\r\nconst getObjectFromURL = (url) => {\r\n    const obj = {};\r\n    const search = url.slice(1);\r\n    const params = search.split('&');\r\n\r\n    return params.reduce((acc, item) => {\r\n\r\n        const [key, value] = item.split('=');\r\n\r\n        acc[key] = value;\r\n\r\n        return acc;\r\n    }, {});\r\n};\r\n\r\n\r\nconst App = () => {\r\n\r\n    const hashObject = getObjectFromURL(window.location.hash);\r\n    const searchObject = getObjectFromURL(window.location.search);\r\n\r\n    const vk_group_id = searchObject.vk_group_id || '';\r\n    const subscriptionId = hashObject.s || '';\r\n\r\n    const [subscriptions, setSubscriptions] = useState([]);\r\n    const [isLoading, setLoading] = useState(false);\r\n    const [groupInfo, setGroupInfo] = useState({\r\n        description: '',\r\n        avatar: '',\r\n        name: '',\r\n        unsubscribeColor: '',\r\n        subscribeColor: ''\r\n    });\r\n    const [isGroupInfoLoading, setGroupInfoLoading] = useState(false);\r\n\r\n    const loadSubscriptions = async () => {\r\n\r\n        fetch('https://smm-n.targethunter.dev/api/subscriptions/get', { mode: 'no-cors', method: 'post' })\r\n            .then(res => res.text())\r\n            .then(data => console.log(data));\r\n\r\n        const subscriptions = [\r\n            { id: 1, name: 'test 1', count: 1, isSubscribed: true, banner: 'https://scx1.b-cdn.net/csz/news/800/2019/1-nature.jpg' },\r\n            { id: 2, name: 'test 1', count: 1 },\r\n            { id: 3, name: 'test 1', count: 1 },\r\n            { id: 4, name: 'test 1', count: 1 },\r\n            { id: 5, name: 'test 2', count: 0 },\r\n            { id: 6, name: 'test 2', count: 0 },\r\n            { id: 7, name: 'test 2', count: 0 },\r\n            { id: 8, name: 'test 2', count: 0 },\r\n            { id: 9, name: 'test 2', count: 0 },\r\n            { id: 10, name: 'test 2', count: 0 },\r\n            { id: 11, name: 'test 2', count: 0 },\r\n            { id: 12, name: 'test 2', count: 0 },\r\n            { id: 13, name: 'test 2', count: 0 },\r\n            { id: 14, name: 'test 2', count: 0 },\r\n            { id: 15, name: 'test 2', count: 0 },\r\n            { id: 16, name: 'test 2', count: 0 },\r\n            { id: 17, name: 'test 2', count: 0 },\r\n            { id: 18, name: 'test 2', count: 0 },\r\n            { id: 19, name: 'test 2', count: 0 },\r\n        ];\r\n\r\n        const s = subscriptionId\r\n            ? subscriptions.filter(subscription => +subscription.id === +subscriptionId)\r\n            : subscriptions;\r\n\r\n        setSubscriptions(s);\r\n    };\r\n\r\n    const loadGroupInfo = async () => {\r\n        if (isGroupInfoLoading) {\r\n            return;\r\n        }\r\n\r\n        setGroupInfoLoading(true);\r\n        setGroupInfo({\r\n            ...groupInfo,\r\n            description: 'В этом списке рассылок можете выбрать те рассылки нашего сообщества, которые будут приходить в максимально неудобное вам время и которые вы не будете читать. Независимо от этого мы будем их вам присылать, так что подумайте дважды',\r\n            avatar: 'https://sun9-44.userapi.com/c845418/v845418151/d56e6/f677KFnZxQ8.jpg?ava=1',\r\n            name: 'pictures box',\r\n            subscribeColor: '#ff8000',\r\n            unsubscribeColor: '#8080c0'\r\n        });\r\n    };\r\n\r\n    useState(() => {\r\n        loadGroupInfo();\r\n        loadSubscriptions();\r\n    });\r\n\r\n    const source = 2;\r\n\r\n    const item = subscriptions.find(subscription => subscription.id == subscriptionId);\r\n\r\n    const pageDescription = item\r\n        ? (item.description || '')\r\n        : groupInfo.description || '';\r\n\r\n    const subscribe = (item) => {\r\n        var s = subscriptions.map(item => item);\r\n        var i = s.find(subscription => subscription.id === item.id);\r\n\r\n        i.isSubscribed = true;\r\n        i.count = item.count + 1\r\n\r\n        setSubscriptions(s);\r\n    };\r\n\r\n    const unsubscribeItem = (item) => {\r\n        item.isSubscribed = false;\r\n        item.count = item.count - 1\r\n    }\r\n\r\n    const onUnsubscribe = (item) => {\r\n        var s = subscriptions.map(item => item);\r\n        var i = s.find(subscription => subscription.id === item.id);\r\n\r\n        unsubscribeItem(i);\r\n\r\n        setSubscriptions(s);\r\n    };\r\n\r\n    const unsubscribeAll = () => {\r\n        const s = subscriptions.map(item => item);\r\n\r\n        s.forEach(subscription => {\r\n            if (!subscription.isSubscribed) {\r\n                return;\r\n            }\r\n\r\n            unsubscribeItem(subscription);\r\n        });\r\n\r\n        setSubscriptions(s);\r\n    };\r\n\r\n    return (\r\n        <View activePanel=\"main\">\r\n            <Panel id=\"main\">\r\n                <PanelHeader>Рассылка сообщений</PanelHeader>\r\n                <div style={{ textAlign: 'center' }}>\r\n                    {item && item.banner\r\n                        && <img src=\"https://scx1.b-cdn.net/csz/news/800/2019/1-nature.jpg\" alt=\"Баннер\" style={{ maxWidth: '100%' }}></img>}\r\n                </div>\r\n\r\n                <div style={{ padding: '15px' }}>\r\n\r\n                    {(!item || !item.banner)\r\n                        && <p className=\"page-title\">\r\n                            <img src={groupInfo.avatar} alt=\"Аватарка паблика\" style={{ borderRadius: '50%', marginRight: '16px' }} />\r\n                            {groupInfo.name}</p>\r\n                    }\r\n\r\n                    <p className=\"page-description\">{pageDescription}</p>\r\n\r\n\r\n                    {subscriptions.map(subscription =>\r\n                        <SubscriptionItem\r\n                            item={subscription}\r\n                            source={source}\r\n                            subscribe={subscribe}\r\n                            unsubscribe={onUnsubscribe}\r\n                            isSubscriptionPage={!!item}\r\n                            key={subscription.id} />\r\n                    )}\r\n\r\n                    <div style={{ textAlign: 'center' }}>\r\n                        <button\r\n                            onClick={unsubscribeAll}\r\n                            data-source=\"1\" style={{ backgroundColor: groupInfo.unsubscribeColor }}\r\n                            className=\"subscriptions-group-button unsubscribe-button unsubscribe-all\"\r\n                            id=\"unsubscribe-all\">Отписаться от всех рассылок</button>\r\n                    </div>\r\n                </div>\r\n            </Panel>\r\n        </View >\r\n    );\r\n}\r\n\r\nexport default App;\r\n\r\n","import 'core-js/features/map';\r\nimport 'core-js/features/set';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport connect from '@vkontakte/vk-connect';\r\nimport App from './App';\r\n// import registerServiceWorker from './sw';\r\n\r\n// Init VK  Mini App\r\nconnect.send('VKWebAppInit');\r\n\r\n\r\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\r\n// расскомментируйте строку с registerServiceWorker();\r\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\r\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\r\n// registerServiceWorker();\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n"],"sourceRoot":""}